---
description: "Supabase/Auth/スコア保存周りの注意（セキュリティ、運用、SQL）"
globs:
  - "src/js/**/*.js"
  - "supabase_setup*.sql"
alwaysApply: false
---

# Supabase / セキュリティ ルール

## 認証（最優先）
- パスワード/秘密情報を **平文で保存しない**。
- 認証は可能な限り **Supabase Auth** に寄せる（独自実装での認証/ハッシュ/トークン管理を増やさない）。
- クライアント側に置く値は「公開されても問題ない前提」で扱う（特に API Key/URL の露出に注意し、運用ポリシーに従う）。

## データ保存（スコア/進行）
- クライアント都合だけで信用しない（必要に応じてサーバ側制約やRLSなどで守る）。
- 既存の `supabase_setup*.sql` の意図（テーブル/ポリシー）を崩さずに拡張する。

## SQL の作法
- 破壊的変更（DROP/ALTER）は極力避け、必要なら移行方針を明記する。
- ローカル/本番で差分が出ないよう、SQLは “再実行可能（idempotent）” を意識する。


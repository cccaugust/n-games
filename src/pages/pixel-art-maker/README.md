# Page: pixel-art-maker

## 概要
ドット絵（ピクセルアート）を作って、端末内に保存できるページです（まずはMVP）。  
将来的に、作ったキャラ/モノ/地形を他のゲームで使えるようにするための「共通アセット置き場」になります。

## 操作方法
（画面上のツールを選んで描きます）

### 画像からドット化（NEW）
- 編集画面で **「画像を読み込む」** を押して、画像ファイルを選ぶと
  - キャンバスサイズに合わせて縮小（縦横比は維持・中央寄せ）
  - 自動でドット化して反映
- 上書き前に確認が出ます（**「もどす」** で元に戻せます）

## 仕様（MVP）
- **種類**: キャラ / モノ / 地形（メタデータとして保存）
- **サイズ**: 16×16〜256×256（MVPでは「新規作成時に選ぶ」だけ。既存作品のリサイズは未対応）
- **保存**: Supabase（DB）に保存（ネットワーク不調時はIndexedDBにローカル保存して後で読み込み可能）
- **書き出し**: PNGとしてダウンロード可能

## 画面の流れ（UI）
- **最初はギャラリー**が表示されます
- ギャラリーには **検索 / 種類フィルタ / 並び替え** があり、作品を探しやすくしています
- **新規作成**: ギャラリーの「＋ 新規作成」→ モーダルで「なまえ/種類/サイズ」選択 → 編集画面へ
- **既存編集**: ギャラリーの作品をクリック → 編集画面へ
- 編集画面には「ギャラリーへ戻る」があり、保存済み一覧はギャラリー側に集約しています

## 実装メモ（設計）
- **エントリ**: `index.html`
- **メインロジック**: `script.js`
- **スタイル**: `style.css`
- **保存API**: `src/js/pixelAssets.js`

### データ形式（ローカル）
`PixelAsset`（IndexedDBの `pixel_assets` ストア）:
- `id`: string（assetId）
- `ownerId`: string（player.id）
- `kind`: `"character" | "object" | "tile"`
- `width/height`: number
- `pixels`: `Uint32Array`（`0xAARRGGBB`、`0` は透明）
- `createdAt/updatedAt`: ISO文字列

### データ形式（Supabase / DB）
テーブル:
- `pixel_assets`: 作品メタデータ（1作品=1行）
- `pixel_asset_frames`: フレームデータ（1コマ=1行、`frame_index` で管理）

※ 将来の「歩行/攻撃など複数フレーム」追加は `pixel_asset_frames` に行を増やすだけで拡張できます。

## 既知の課題 / TODO
- 既存作品の **リサイズ**（拡大/縮小、キャンバス拡張、トリミング）
- 塗りつぶし/直線/矩形などツール追加
- 色パレット（最近使った色、固定パレット）
- Supabaseへの同期（複数端末共有、公開/非公開）
- 他ゲーム側で `assetId` を指定して読み込む仕組み（キャラ選択UIなど）


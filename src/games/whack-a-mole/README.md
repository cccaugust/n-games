# Game: whack-a-mole（モグラたたき）

## 概要
穴から出てくるモグラ（🐹）をすばやく叩いて、制限時間内のスコアを競ぶゲームです。たまに出るボーナス（⭐）は高得点！

## 操作方法
- **PC**: モグラ（穴）をクリック
- **タッチ**: モグラ（穴）をタップ（Pointer Events で統一）

## ルール / 仕様
- **目的**: 制限時間内にできるだけ多く叩いてスコアを伸ばす
- **時間**: スタート時に 20 / 30 / 45 秒を選択
- **むずかしさ**: かんたん / ふつう / むずかしい（出現スピードと⭐の出やすさが変化）
- **スコア**
  - 🐹: +1点
  - ⭐: +3点
  - **コンボボーナス**: 連続ヒットが続くほど加点（5コンボごとに +1）
  - **ミス**: コンボが 0 に戻る（※「むずかしい」だけ -1 点）
- **ゲームオーバー**: 残り時間が 0 になったら終了し、ランキング表示
- **ランキング保存**: ログイン中は Supabase の `scores` テーブルへ保存（game_id=`whack-a-mole`）

## 画面 / UI
- **HUD**: スコア / 残り時間 / コンボ、タイマーバー
- **スタート画面**: むずかしさ・時間・音 ON/OFF を選べる
- **リザルト画面**: スコア、最高コンボ、命中率、ランキング、リトライ/設定変更

## 実装メモ（設計）
- **エントリ**: `index.html`
- **メインロジック**: `game.js`
- **主要な状態(state)**:
  - `score`, `timeLeft`, `combo`, `maxCombo`, `hits`, `misses`
  - `settings`（difficulty/duration/sound）
- **出現ロジック**:
  - `peep()` が穴をランダムに選び、時間が減るほど出現スピードが上がる
  - ⭐は確率で出現（難易度で変化）
- **入力**: `pointerdown` を `#grid` に付けてイベント委譲（スマホの二重発火を避ける）

## レスポンシブ / マルチデバイス
- viewport: `viewport-fit=cover`
- セーフエリア: `.whack-page` で `env(safe-area-inset-*)` を加味
- ゲームエリア: `.grid { touch-action: none; }` で誤スクロールを抑制

## ファイル構成
- `index.html`: 画面（HUD/設定/オーバーレイ）とスタイル
- `game.js`: ゲーム進行・入力・スコア・Supabase保存/ランキング取得
- `README.md`: このドキュメント

## 既知の課題 / TODO
- ⭐以外のバリエーション（例: じゃま💣）を入れるか検討
- 効果音をもう少し「叩いた感」に寄せる（WebAudioの波形/音量調整）

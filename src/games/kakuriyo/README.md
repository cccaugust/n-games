# 幽世の試練（かくりよのしれん）

和風ターン制ローグライクゲーム。死んだ剣士「影丸」が黄泉の国から現世へ戻るため、100層の「幽世塔」を踏破する。

## 概要

- **ジャンル**: ターン制ローグライク（不思議のダンジョン系）
- **目標**: 100階を踏破して現世に戻る
- **特徴**: 死亡するとレベル1・持ち物全消失でリスタート

## 操作方法

### PC
| キー | 操作 |
|------|------|
| 矢印キー / WASD | 4方向移動 |
| テンキー 1-9 | 8方向移動（斜め含む） |
| Z / ピリオド / テンキー5 | 足踏み（ターン消費） |
| ESC / スペース | メニューを開く |
| I | アイテム一覧 |

### タッチ操作
- 画面下部の方向パッドで8方向移動
- メニュー・ダッシュ・足踏みボタン

## ゲームルール

### ターン制
- プレイヤーが1回行動すると、全ての敵も1回行動する
- 移動・攻撃・アイテム使用はすべて1ターン消費

### 満腹度
- 1ターンごとに0.1減少（1000ターンで0になる）
- 0になるとターンごとにHP-1
- おにぎりで回復

### 視界
- 部屋内: 部屋全体が見える
- 通路: 周囲1マスのみ

### レベルシステム
- 敵を倒すと経験値を獲得
- 必要経験値 = レベル × レベル × 10
- レベルアップでHP+5、ちからが確率で+1

### 死亡
- HP0で力尽きる
- レベル1、持ち物全消失でB1Fからリスタート

## ダンジョン構成（フェーズシステム）

塔は7つのフェーズに分かれており、各フェーズで異なる色調・雰囲気・敵が登場する。
フェーズ移行時には演出が表示される。

| フェーズ | 階層 | 名称 | 特徴 |
|----------|------|------|------|
| 1 | 1-10F | 黄泉路（よみじ） | チュートリアル。基本的な敵 |
| 2 | 11-25F | 古戦場（こせんじょう） | 武者系の敵。武器・盾が多い |
| 3 | 26-40F | 餓鬼道（がきどう） | 飢えた敵。食料が少ない |
| 4 | 41-55F | 修羅道（しゅらどう） | 高攻撃力の敵。赤い雰囲気 |
| 5 | 56-70F | 畜生道（ちくしょうどう） | 特殊能力持ちが多い |
| 6 | 71-99F | 人道・天道 | バランス型。強化版の敵 |
| 7 | 100F | 輪廻の間 | ボス戦。輪廻守との対決 |

## ファイル構成

```
src/games/kakuriyo/
├── index.html        # メインHTML
├── game.js           # ゲームエントリーポイント
├── core/             # コアシステム
├── entities/         # エンティティ
│   ├── Entity.js     # 基底クラス
│   ├── Player.js     # プレイヤー
│   └── Monster.js    # モンスター
├── dungeon/          # ダンジョン関連
│   └── DungeonGenerator.js  # マップ生成
├── items/            # アイテム
├── systems/          # システム
├── ui/               # UI
│   └── Renderer.js   # 描画
└── data/             # データ定義
    ├── monsters.js   # モンスターデータ
    ├── items.js      # アイテムデータ
    └── phases.js     # フェーズ（区間）データ
```

## 主要な状態・データ

### プレイヤーステータス
- HP / 最大HP
- ちから / 最大ちから
- 満腹度 / 最大満腹度
- レベル / 経験値
- 所持金
- 装備（武器・盾・指輪）
- 持ち物（最大20個）

### 状態異常
- 混乱: 移動方向がランダム
- 睡眠: 行動不能（被ダメージで解除）
- 金縛り: 行動不能（被ダメージで解除）
- 鈍足: 2ターンに1回しか動けない
- 封印: 特殊能力使用不可（敵のみ）

## レスポンシブ対応

- PC: キーボード操作
- タブレット / スマホ: タッチ操作（画面下部のパッド）
- 縦横回転対応

## 素材

- ドット絵: ドット絵メーカーのサンプルとして自動生成
- キャラクター / アイテム / 地形タイル（すべて32×32px）

## TODO / 既知の課題

### 未実装
- セーブ/ロード機能
- 合成システム
- 未識別システム
- 店システム
- ダッシュ機能
- 杖・壺・矢の使用詳細
- ボス戦の形態変化
- モンスターハウス
- サウンド

### 今後の拡張
- 持ち込みダンジョン
- 図鑑システム
- 実績システム
